<link rel="import" href="/bower_components/polymer/polymer-element.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="./ps-pizza-service.html">
<link rel="import" href="./ps-pizza-routing.html">

<!-- 
    Etry point of the pizza module, will be responsible
    of routing its components and will act as mediator
    for managing the pizzas array between its children.
 -->

<dom-module id="ps-app-pizza">
    <template>
        <iron-ajax auto url="[[_baseUrl]]/pizzas" on-response="_onPizzas"></iron-ajax>
        <ps-pizza-routing></ps-pizza-routing>
    </template>
    <script>

        class PsAppPizza extends Polymer.Element {
            static get is() {return 'ps-app-pizza';}
            static get properties() {
                return {
                    _baseUrl: {
                        type: String,
                        value: PizzaShop.config.baseUrl
                    }
                };
            }
            _onPizzas(ev){
                window.PizzaShop.pizzaService.pizzas = ev.detail.response;
            }
        }
        customElements.define(PsAppPizza.is, PsAppPizza);
    </script>
</dom-module>